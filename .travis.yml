sudo: required
dist: trusty
language: java
services:
  - docker
env:
  global:
    - CLOUDSDK_CORE_DISABLE_PROMPTS=1
    - secure: VV9EGl+gkXdxCsXMYH81sABKXd6cwDghgfYxuxwXfdjItKp/YW8jkxrhZgMvJGggy0u2t3JhWNxdkFb2Q1WdPFgTP/+33OmwXdj0qPf55IT8cGQgvj0Onj7xpybuAwbaihgxCbfsH8FefCBZbzzf7hW4QbJ83NrUajEDK1NMbpP1Rxq2a/Bjsm/kw7hAXx8ERrZzXom4qKN9Df89mNg+gmBEF000KshRId/84CRDWwlA+5APwOpNhki8hGTDt1CdTee/pV7pjQekvHdt3id//bLzap56qSgC5OZAxflB2hn0+0KIJGjee1mNwY/OF5JDIuJFzFJ/KLOC7Tbdxm6pnSyfzw/YMmI3FKlRg64Lo0/8VLI4brfAGji3ogpeE7jXa7QmF/34LfKusNlQEY72GBTi02v1U/ZCsyet/izgJLET9r+33WmaUwBSfjYodyFyL+Hoe25J4NcXWj01WLTBPf9wq0fAPTnQ8SWkfj3V2UvfymgtqRHaGcBGj4FyFWsgjiv6Iy+8fwlfLMOUtFcwtmuTWZmLB0iJlRVYNqgdmFNDqG9ieqbv17X68J9i+HaHH0MCc/ozZinOQfTJ5es+rOH7Mw9yIhZKYbAyNPnVRyGquKDOyfwa9cP44niC8x14QOhsoAeVrDq15L1SIooVzEzo08auqxrTv5eTaKJXzjI=
    - secure: 3GqA1FmQXyQsYsafZrLF1RBMNwdbnsC+u6vRz1+ljmnGYiywPNkr2woDRVRok+nXEvu9qSVraR+dmZp0zvd0XhnrJtKfXi0I3sZCimS9HcWkpSKgGWy+3EnsNODp2Uu1uO8YIoBAzZSQlBwY/DNqLYbYOFrRN0IAiPJMrg7OoUX9TEMqANTNsXLK+UCUnWuIUvLKbhSI910uzRo62GZ+LGiF9uyXBQxSarUpztb0CO6zbc1Z9YpMxxP9rD7AYQBWBq8yQokOQK2jbJzWm25xu4Q5mVzFvgTWCRRWCnpULQLpSAvtsmFtYfnz0lbChx+aUQwxFGj3MAN88TKGDjwtIz3VEbf4v+B1OgdfVIW2jzCFxoGXssgMSPmshToScTkX68kiw1dKae1JncPs+iu7XRr/YcemiJsgvWjk3fgg4WM3JTHH0GCPZQ+A3fCpL6MIbVWThLM5su3NXNhXTBqVl2RANku7XM6wEtV5IhRbIO8bBuR2GoGMMwGbnotvLCVIrGKQContzY8HHJyE8aLTPNIpgqip2l9Uy1mnCmctFQ4e05eQS7fBgeP7ajvzNlkM8NcGH+jc7ZqQMCyXRHUje8mU5VrJIEdLRoDszKSDrYpOaHXYuju0egylJPzujqXctj8RdxMcftQFtD8lvyYLzxlpAAivPtSpushbhGEG3sY=
    - secure: XPQCrrBICw0JK309oI6ir8F0Gv4/jUSYmkaZct//voxc1mYH1I7B/jJlnFa2wo5VEacqmbQ4KWurAxhSrae6kJXI06Zyehzt//aZyZtrhVFkE2HGREt5k5vECckASO6T4+luA20rWv/iLtk+97KUuge35m4uqTOxSSZLyiX8se0G2iKmQCNRdy1CCsMLTPYnfkO3NMVddSi+ihYIJsv3+C/vZTxW/94N8Y7k8j0SGJ/oUI5SnntY9TLBFVYB2/uTtIfW6ua96mTxdLF1MLmBAnOZzVnfwydINtY53j3xSIxfTH/0ov3GQPISfQzgwzhi/T725euHHy4XajhAeoaqFQebcD9ZrQfsSdfq4OKJtoO5RAYuZ4dB7HKt7oVUkOTI/fAmOEYt+HkL6ulgD7NnRZc6OmezBxBS7oKYZOdKHlrx5Pl1OAiVhBDzWMcYu9/Nyb2yaPu92Ny4QkAvDpNJZSeknx1vJBQuUUzHcFOio6Qctu+AYUmpJZS8dw1AFwPURXkQHPRzog2zNDQkLJ4TnrnEkO6tssShY4Bf39epsKRbwMBJYz/0vXIvaq6oD0fV18o2T6Vrh5dei8DYInu4Ko1L2+rxyWTISCrJT1pHi96kr46o1sQl8zmwjMqSQ6XcseUnLuADfVKVbLurawfzOSgAQhUoVm3hGLGzSTAtM5g=
    - secure: V+t/t15k8bVu4P4maMbdtTRgCG2B9tf077xQOqp5wLWHC/vQ0KXvuPK9+Dw9OQl9rQXbwRfptXTl6MvBB7O5zjz+ujBsFjLkIc1fieyt3V/xoaEEzsL6V326cZ04gqpN72az/3WWtNhKQFt7lPhq0kbOEIY/eaOULOWr8aaIhwGZbg+KiF8/HuDMEifZ1c0PmJNeWsQn6i8RATcJYPCmiGm81/fxe7zzcT7zAFrJtHxmR2tU76X0nvczDI5UecfQLS9BYMxWjExhN+pCDG/34o2vDLRZazBv7k7DdVsxqD+CF5LoyjLeQLSDpJsLqyu/zRNnEVkG5e/QuNjGJuKevtsGC21++624Um2I9ZHxt5OgxGdT56OQshLddxinljNLDYh1LO1dIqheGu2BzGKembG+XlzKYzyJSLZQjiHFsMNTkSMWt5r/rcdqRtGS9r/qkM3XEDvQfbpmU9M3qdypNeSpEpcqL3lECPSOYYSjOu69kd+d6Hbf2MwOg1heecoYQKSyx3TH/nTi+cYTJw1KvNkHSaVwpU7n9+SuZYq2addk/1opmuVwXiMC/hf2feUxF71M9EuJqhJtHzC5DNcfgMF3bCzQzMUybhnm+idZv2fOlImzzLZDjDiby7p2Gph2Zno0hSzWptCXGaRUyghYW9bTMcKS+HZW8JwftwfxUOY=
    - secure: APE380KIUiQk8YyXBlqLHlK5UvjQt/c1iksvcVwYoXtWhpJ0Xj9Z6Mf1mmGXiRZINaEP9GAIlR22Ldb589P6wfxbAHv23E+eGw0ADxag7ocq5hugDXSNu6lHObeSypEi6sq38PRe5FEr04nP/5pBVeK/z7UbL8cEDOShjitodExXxP3OzptYb5zedSYXro2PjhER/RoI+oM8v+Fsqxgo2gCn0F1uEI9GE6nw+AbNtteFAZvq9a586p4VN5xqH2FU8Gofg4t5ijAzEYCoo/dbHPgFNOOkn13YQ09gJJmWBVKHEB+9dVNKV2R5/dT6B/+GxTS3AtYMBrzEQVWjcSYu31k40heLk8JPOQYmnN5+kwJUTjH90PYqOStnkLKxgrDf/uvR8CJ3nbpqmuO1W4nJN/G8YFGjTqgZpJzUkwyOyoUQPJBg51UyKfhTNrXujZfumsuG392cfLNRU3VtQeNMmt94T9iCxgaFPTgWZz0QVKGO5BuZxQQoQwOmtU7pk8fNTMAvFz2lfwf9HBymKtz45iDX4kn8FAYJj4OiHzC2qTMLsESdHQZd9dUzVk7gxXhzqgF1qAsd1Pw930MdbfRCaeQ9yJs2CjFE4w78NADZlCSXzyxZISQFSdUrB9SN7jWWhsB/dKv6LedaFyrwAhkiK8hl4QyeVejo2mueL+f6dc4=
    - secure: wjphAg7ajKby8tr/ZOHQftUAdmqjK29Q9ZbjPftFmeFu9PO6l7Dj4GQYEFZxG2He6gdhKzveeQInWIZFw/uIBPpNWRQJnl23abpW7iTMm+YbpcbdeuhjtJJV7h4SYPRUD5OPKHKG6CHkNCxPjU50KZB31BOISHTEtVuyyl8BLgvIs0cMCdjcAZd88oWriW004nBWXI4Diy+YFu7V1pbtg9AA9ZcjV/BIfrjx8Qe2sSbZOifml2IAxZBPG/t7Opz+z3+CFgBDGePbPhAJzeml8lhGzaXFfUcEb6+XkiX8Ujr9BKoJNYr3Vwi0+H4x8a+ZIF5+2y1RzOoFf5mZ1MqrHQHJT9cmFfnF/+zwWFsdgti7u61bWrEQpkNePobZrq4uHCT6XeiHRnajpLeRU+cvIknw1j6rcTBqD7WNBuvM4o/OzDgohZw+koUL/CUp63zbIBqHVBJcJTrtOXLX+PgGxPAyrhDHBNqUdlfEGDGXlxeFrkDlvtACbj2SEq3cXPbBQvyfcwAFWfbKA0cubTBFaQofV2txzM405hR+wep3rT3zwKnXnNphvLUQH3jtJGcnZWQsRpr2L5rizLHZqk93igeNKOnLCdTn+seo3WlTgRgKi5rporUm1wRUrR3XRnVcEUEx7j7+df5BvdLi63cDiz4E8/qKkEzvSkf3SjRYARo=
    - secure: SrWoyAdzDOp+JF3M38V+ZrdOPLctG21NppBEpamgedCf+y7IemUWURarDQ8DPCSMteIfAnrfLxH6X55mXnuPGMfF5h30F0XnfeA9xEhz1YtAXDJ6KlJIqLSJdlZWWydDuwqe7XVdOz1aovnQLD7z2Xn2+PocsoMbZwhpmu0x6E1erH2+UqXXEX75bR0JWljv1gCtpoi1FmhhL0rab2iBFiPrSDLx06KrIanIzz0SpwIs/B7KXTajJmjXiwDN1Vnl1WAxC+WEsthv39rb38lhyDo97I0nkCrEefGZOSowYbsUFZ6SFyCoF9BrKIqOtVAu/8+9FehSSUIcHEJJdLSc5esBAQndw73kZcCO0tuD/3YIsiX/ganCTajPOs9mv/Bhl92+s/bacAVFLhfj03Sf1HiVb+2VCUeYRi1tA1mWm9HWpIVqAZO9DyiEN3wfNAeniFJ5PphrU63UJGUhrCysLOF/g54bUGpON3cc9R9BOX5ES+Xgm4ooK/dZU9pCGhkoLBqDIhG2qgpo7qdGvAhs84UgQ+JR0PO8mM5QNTBaWgGwyKJCMh10ixjfzmAw8D4s2P7QsNfLAIa5/MdJ0GU3VLY+ZylrO+4YruMPtKM5aRGTHVPAIeOrCtYVFGCFGblS7EunGU9lAIgpUc+BFBiaBAnUwMUnV0rGdEnMKhMqOuk=
    - secure: jo2LtRWHTOwF0Mc26xTCiSCMJTOxYfTpKuZBV0uS0cDlv8LnqLoPRKeZTMBbYVpQrLkPCFi1FXyMr5sepwr1HVndWWz06+0ntzjLGVH3sJuF6WJJXhBarshHlH7MvDHxVgUs4qVvqzwzLj6/WbcUv6EjsTcoynAHEWzTlexSTg50bGXEg2yMrPfLkrzZ0O7D6W0X4XfLKzY6lVrXydMmRDDn7HFs04yWy6zMabgzxGcZybSrP7mqQ4zhMjify58UEIttE7Q5bMUkoZLKYtV+B9B0qlf9sXIq99MJN1K22C/6G2r0oV1R0PG6Pp9veqbsCU+qGjG4yCflGmqDfn7Me2pyzQfIqz+vatgWHyd7fcXXNhBkh8QyQwPQhUkp3s/6JrbjWzNt/fL8t7o5+3S/h+jclOSOPHVwS7Is8O3+KLrPh61pfMaS0VKeLH4eIDHrSJm53JBfnz3+sxjoWK3K0kEpmvhKOlMzhJd5Vo0v21XCpI2Ab2jeakEKBnvp4tV2rU9RHY721fudyp1IuQXPUPgPCKROXN3TqbhkTsFROfhjlc59sADj5MDF36wU3AKKtCKZEAj1SjEjAtHQcpjrU232YHmX27Z7YqE+UlTIMQ0VAGsYgabxalonT2CnVWcO09rgy3BujKrFj/WE5vYVvvGBeShH2N5zPmCUF3EgXaU=
jdk:
  - oraclejdk8
before_install:
  - source infrastructure/set_env.sh
  - docker-compose -f infrastructure/docker-compose-services.yml up -d
  - if [ ! -d $HOME/google-cloud-sdk/bin ]; then rm -rf $HOME/google-cloud-sdk; curl
    https://sdk.cloud.google.com | bash > /dev/null; fi
  - source $HOME/google-cloud-sdk/path.bash.inc
  - gcloud components update kubectl
  - gcloud version
  - chmod +x mvnw
script:
  - "./mvnw clean install"
deploy:
  skip_cleanup: true
  provider: script
  script: bash infrastructure/push_image_gcr.sh
  on:
    branch: dockerize_service
