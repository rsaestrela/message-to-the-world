sudo: required
dist: trusty
language: java
services:
  - docker
env:
  global:
    - CLOUDSDK_CORE_DISABLE_PROMPTS=1
    - secure: KD81Xt0XrbnbhSHQowyuOaxqDmZsKrN3Oh5Kgy7/uf7vByl3nEbJ6n+kJ90zMF9Izwcy6xEU4a72ADtAqD8UJ0NcZzmC3RXfYGUjj6ARGYPrf6YfXTEaKfgsprQI3feQga+1CKM2agMBuMeHvvtdGmwaunJlAL8uTqQwrtp3hkP2WUzEIw6wzVK5T/HiNBB978jxAzQqo0cBvGaS7p6JzQva8SQhuawx9MBYHVpYmJ019/rd2eATDT9ADA2aQx6uaW/1ZvVi3JehjkETapOiH02YXvH/Xs1Ku87CopdloR3YAZ0CtCtgv2cw99TrzlHJXL/1wHGSCyH+WJ9Lk53LKwQJgN5jBeS9JBnaAYAaCY3fjxxCr55LSAI4WApWt2v7TL+9tXcjBeC34gZI0MQZ8hBJuLJFvAiCp0eQMfg+ku2Xjhk4nhEKv3BmZAthhtUlhp9tYOoQQc2Rmow/IoNqtSJXsH0bs+NlvvOCBlzMNq4EkaSDmPyrjdhNYQSYCwJiOtqmr4Boweo6TV+0WOvaliqzVTAh7Nh38soAI647BroLmcH8Oju43T4kVSEywG2gSCra3/uFsGaAMU4o2jBoEoDqjL6moCDeLMI4VH1aorvKpeKnL/fY1y7CvoGt3U5vgczvWXXiVjhpjhsw8Wh4FwF0WW5/1v+9OK3AggMsQPw=
    - secure: PbcNWqCTIplc3imIePgHf5HEy3BZIRu64saIw7ltFcGmb1fGUwn3uMooJ3ByxIn7chTZtsRY8T7lZq8kgqBUZeZ7RYmAJ9bAkIWDbtLSPp/679jh6DUMBjyqF+pwH09NCvIvBlAiZva2y543gYXc17dyU/B/VuRye86LnUJaCWNZuyhrAQUa2JOT0GyctksGvORh+p47sQ0JlhlfVIhSLOcnb3WHMVX7OI3tLZSQlkCxlf0yj1G2ce3boJdIclWbtobcMx8yZOY/iMxafmtcydWY1RhDrukr/M8PKv2BJUw5frIcf5uLc50UUzXmACrKzHh3//RnbM3h9KMrBXPblEMs7gRyFQG883nu4N5Bkrs1asp02Wu5X5IDKjFtp7RepF5Cd6hEMjTRjo4/lRlrXQbgFYJf+5lBEjtIMPCx3LjN61mqZxWZigWERV9hiva0lE0HW8+S/5U18+lxkRgRkZRPvsCg4dj5q1ciYv44AUwaY3Wp87QympEi3sqESztBuBTNfzdduiHfGGk2Nw7cMGSXOZjQITITlvRQSmoilXcmztCvna3WaCWy+jxh7CsflCIPIJkW/Oi/h2ffeclFUwEp+pNs3DtOdhNF2NUcSxcuh4jmiZhDUroh3ys8pxuWWMYMS6YL3CKbVC0JcqwxVqbFQZPtL3RBG8enDKVZ3OA=
    - secure: QJFgmdK4qY5YAN08e0CfWRpwv9195gkIRoKZSDxAw3q1FQsOWdsHEb2pEYXg+bXrMPp1On2B49Wc+57CqxNFuureUwJq3EKfP0UPj+VX0aVjDaEI1FAmSpQgbdAp/QGlJWf94XaCzy4OhQOlcyWkXrJ8k3XgKWqYUFLgV2RbQK7hPorFg+H9DMcQji5QbMfc8ReEQdUPKgPFXqcrDG/LSgtma6ig9T+9lEXAx+XrP5z0eUetz9tMCQxXhNSh8TePnmhh9fDPdVGsJnFefopqyYVWXD6nrtqru4+GwZKVJ0EyN5LEsGSKZVj+2FtN87+j4hIAjX11kcxpX1Dq3AC7HOhDhEfbdgvaKFjBchnFuHhAn8E6y/B29s83If6ZdbVrHjdgoplaZ1O1lHj87Yf6XoVYVFAfVZ4yJ3JOaBrEjzir1KrUHrUoKPNiqyYCoosL3lMqT7LYmvkOX6fqoRk74mR3odyHc0NVvMxAgLh1kUwjRFle99AfmOOTlLkTQ2vyzJKpVHQDonZClMiOHbJZ16//3AdbMAMnpk9fLCaxjBX7xGmMPQbRtw1IYCbgwzqnNXCtdig4wZL8XviYPaXV4RYZ3oSj4Sjqh6BxpB2zsoCmnqfLzYFgYqinrKSyPWfOAhsCmtSftgBKr95z+K+uTNJgIBCwvTgTxjjfdjpPog0=
    - secure: n73qZ/Tkz3tktP3Nu6CDMM3emv5dt25qCF6l6FNhtLDNXpi2iP3deaA7tk+zViT8eQ2SdRGifPaIAQ76Az7NLTQ0YOYErr+kSYQn6b7+gGGDvO6nbFK1Z2zrI5PQXINRLSGEM9R03d7VspQoRozmmvvJHuRuZVa/4o87Azi6FPWaQOumKmxJbBeH2oAmKbqYN/s+LptMROEM8fd/oxXDj3rdZGYWxz/mnGl1a+YZ4LPqwknfOUpNrfV59PIjbKZNdiceTjqRBoBGCm53ECqMJN0KZ4uqMyypg04rmpZAb0y2bxz3xmskPSYcnqgM/f6ufePop2jW9VED0YDhnP2Q0glv8cjjx2JibtYBUqstsoZs/VmnrHw73LUs/jplUGiX6Zk4CxrKtw1De1V4vikPaIrNFkj4QnHgQOt6LTzP0WG+9GS1UYuJYMyZ6Ko+SNS8LZiAZgBuLQHMPfLDgA//Mk9QrEwqOQiAJFQTLjKHibTWrCE5MTj2oWjSt8fW8nNdy47InkdOugK2NS2P3W6C2vD5n4Nh1Ug3L1DAAMW1WvDdfvOSxtlQkB0vE9d87qJdrsGs1mQgJl8Fq3+qWQFIrnleIwJIm1UYObxhe59IyztCF7jnf3vvAUtkFc/wcLYdrHCQQfAAU+sKlu4dqgYSRXxBnW4lsYH9C6AmsfzH/r4=
    - secure: U9F8BmUvFgJuzYx1rLrGgRGiDsNVluLEQ68Wrvv4boROX/4ZHDO91VCsmbDavtBamVJWDvgeByQF876zavHFjYMyShMcYAY2wU/BBn4QUd43AzkPoR7TBXXzP47qVjNR4TS6Nd6OCWvVkzRv1xzDh7t2ioVhTqmdcGSJ/BopF/HaGiSF0G5UGqqGYx0U7ph2hvfXG3Uy42Or55v5jaOL+yfHJdap9WZzF/9j/nt8Slxt8sQxI/TbNET48b6itqvHJg1ykQNhrInGrwXAvH40h7iCVNGtq7GPNECMqBkTk401pQ/jginsb6DwIvyzt/u1eY30MZYw2+Y4y5TSXxvnf7Uw4Th4wxYDSjoTXaBRPXXytvFanJ/8VNIlNfOsXbgQfyGJDJ4UOL7vlnPfXL3F1vI26ADcwbYdx5SGqIJB79t6IbnXn4YQImJW90EibQvffgXOUoNiXaD4a6fqGMYxE0HCZcEB67tijGYAzlDSU9NMU1IWWtuyPcyMU2BJ0u5ZNiyXlcHFWaBUR+FOi9uuvaFXUVIjq7LSgbKZ738z/PdMWAwHkwheesvGgnVsUcWGFlUwgRnHNhxf6h/Oriw2E3voea07LllooREFdn5Lh2PpPZzpdCOUs5yCPG6w/0w8qSXufVZX/FcXfd4nIdg/piBOzvhdYJlOUzyvt+Ikvo0=
    - secure: r5Hb92Wltyj7K5ZCjniYubqLM3lVJfiQTBzwp91Z3bI0WT6KtWRBeYyRFshccQ0TGHmFBoD0cvsDj+P1mWjUHC20yTRT7ktVQpVbMp5Vf4vMhjJeGioU7QdH2KYVChhCUkvnzHKZMapjWAd+fyR1FuPw3H4dvKMNTHg+OsM/0Zo7tiLqeWm7mYjDOMyM0M8kC7CdWJq+/gW/Kp7WIXjFr8wVq0Eogl9Jl4/06kh4xRB8Ez97CN+iakjeGS90636QfNtgVOvXyHD5CKmh/Ut0cDT3aFPBhRIhHlswpzDvLM7TbLZpL119ScpMvkcNW4KhF1S8PaBIL7GfJl808hLdGTQn/uXRt6/xZ1QblLNp2oi1c0375owHbj4/mlsqRM8ZMwCHYkE9krG0IRnPtwHUa0rsqgTq2Q/D/DC2JI1jhsdqge0ESnjcp6IaWgtd+bDI1mQX+nAl3niv726+0QBKSyhBsOBjXDsetHgQ6m7GAUtoGNuJSQ+W+a4ladLKk5ZWjinKca/2Tw+siWI0iVQDlCiR4boMMEJVEUL8dF1PLhU1+vaeBBQKrAzRnniHgy5F5nKx3DcydCDFyYKU+UfHDh6pbsVjeZ0gSECgAveQEkqHVd0N7I2EeTTzhdM28n4znVUdou2bZUT2dvDCp1cmvt2Xw708O/FpV1q+fKQWF54=
    - secure: qJhcp4NjaXbWT5F54yCqMzapiDtnxo6Qjw4g7ZpCYItfRzD7sflISqdJm0gB5UWYovB4m5l2/cpulSfk2g/p4fSIgQonYbheDy6EzT0TzkMFiP1Q9bvMq8GzkiAOwGpl1Hs35jgnlTCWb3tgFuBeqU2qLvLa4sN8ECIWVgdfcTkoCjnEECDQsGAkkTffKBHNDS1ct8H3rWSku1Rypk9gZ/h4z3f9QtvyMUNLHhQTcGk6/Cvb3emry+yEZCVweg9TjcJ10iuDCxDZmrK1XvGFP/I3g71B9MdzEU+MitD6FBGMv6IUbUzWwEMCPYg45N543CUTQbMOPKBQ9+hdUBjTRzD+9eYkVkAgr6ZpH3xC80D8WwJP6J+eCKKlmBST/F7ryTp5nTK/4E+lcolNudxz0FHLqxD25/JbS9UcBRmP9LXSNtVOzQ24TBkAvOUT8mXspCuZiCFstBWmBBoK6lxZGUufslGD4X47W1cJKLC7or/8IIMPp9xM0IxaxvSuL6YhXb86z8jDa7GcYcb8tsAdb0OY7wyyU8We6eBXNj1oumTsJTxQXKJ6CdxB633ZG0NbWy4rZVDFCWJNAQDDGSSSICfzBsRVQ/U8QZqCIE/nkMyJiiNMi/lw3XkFBw/pvDhk3osN6nWS+QxAKe6VCCNX+2USA8Bcn1nFsg4jMu6DtDg=
    - secure: R4pwTxq7vJaAT0AtWa5w7lxi6DvzHdT11NalX9wI1N3+CLSOhAr0PXpxwoBHH/774GQ5dseVlKM2Q+WKsrJxdfOdl9NBMvVC7BVfNKhhzSpeAPck/SSlwSkGhUHVxrD8VScQXn+/s6x0mL0OBKzPmqclIwR6ygYNWEADBo2i9xISBoWlE6+GgT/1UOgw1wwiUYmSS3nzS4TYD0JkWTUzofo05xqFrrprrZVZLM1RdConWh7VL87rekmvueINuQudERBqC1sDrtxt2zwixToaJFp0tSGbXVxoLt2wo9WP299WZSQF77AS/XZ+d/Kv+k2Y9eIUkf+FPQGc6S/ROHvm+jbeyr2iSMumUOo+t/FWMZhk75crrxD1Sc32El2+s2nvAJPPYZttnUuwonR+vkRpntjgkhybVAAFGwlp9WTGT4LFNIiNalZOAyhtVDg3JYcZ/3kdllVpAiVqWiZLVT99yUynBDdkEhh466kElrPykVqzZtbigUEnZnVgRNadYxZO53kvBOIfgFMrDBKhgjR5hzDjLlasNC/m6HfvE+PBrHGygZF8438iOesJeRQuLZGL34FZ/lvlwUqxH44SOptykNKQREjBPg0tjSTAkPK+jgooOzOGZwt3+XD52BwzQCLIP+vwjHUgY1FKVwhda5GPX+eSZzb4mKprveaJK0Pu62U=
    - secure: yKawsONAFaHntlh2IWeI62zNA7Lo1MWwYVP+l1s2OIUM3dcEtw2Q9tfZzv9NXhr2Li1BcZY8gSUOj0TxsXTLJpKKAef5xQ7ebzRlOj7DpvWBB/fqlMzertzmgXNU5uI8sYnKlBhZv5pxiRoBlORRJ3MXRYVKbrEeIYJYfkku7XDyDhYtugd42bhjP+bNYxofOmVLpcbg4VXFo19OkdsAK1IFZAea8DAcitw5NmaV1kVBL9v+4Dt/leQmyD0JfsExk8m6XgQz9bzE9Dj6gC/jbHxZmBJy1f5Z02aoQJlZYxt31FpZGydPYSWn8pxLKnGERkdIYg3cnEd3Tx4wJsFvpDQ4Bo/nk2ZpuAvhorNOIQPjFRkjiDuaIYdIH9v0oxuuoRcYz5UUInzBfV0ej/5OqPE7fFYuoZ6aqhfMm0l78zR6wFU0RZT+keECRKI90ohmVbhtA08hVUrYGWpvrA0z1O/Am9rngNzM/xc+3QVUACKlXfKy0rFxW4YORMlNGh5i1RU1O5XzJRTb3n0EuChoUAOC3SkhvZ6lisafN7LyANBOzUQqhLXGAA4gVY96P5sHuemjRAZJ7+4WiEs5VtUfBeHxxDT8ZGQ/IrqQe87Im35D7pjgLnOCpW2AvEYBrZMGHkQdJalmZOy4ZFNtfMdTVvEsnx2x6mVbryxhbFWXZJA=
    - secure: rboQGRD3TBnLop/BG9bQaEGx64CxOEy9tChWtMJiZmBr7HIVk0e39LKzWpRFFKvwJPz/p+UbdbhE824v1abv1Ukdj36JkSfYKamU6DwvoDKUj+/1RHVoEshnvHPel5tg+Am1u6ALLkYGupk84CdC8jdnGV4m0wvBAn3yPElVHcpD7H7YgicJwuOik9Ag2SAjrOlCvVg4SuKYolK95tGNrsUetnt1TVR6A6XgKk32HgQKtVKEjJdf7VWaZN3VcAZC0XZ1mPn6CYt0KUEGwEL0I02Lq2iOWM+Wegk4RPMb5gxhy6xKnMCC+xFv6aNMRupghff2shF3nXIQBitrX9WHtWaYUVi2qA5lINZx3LyStQeexzie8jHVyiSFrpaDW8C0ZEixcWwuBZTQcbJFzHT5gr8l0Z8V2FrAFypjYFR1RjWZ4WpvxMLfLptWJrLxYLF1etWImmjCCXtWMG3ur8ZyL/kP0d/6+ejwHNR/7j9QIFf03+Az2iq9+SyFYN8rtxsKOVRbHThNme8LGqjj5Fp9rYYhTLP78mUkrS5Ef/zJn0wUsuittpCu/TndfkNabKC7GPQfPjC4ztC6ioj0JLv9asiWwgO1EA+82969NFebRTwLM9lAGJO+ETSdqdWFnkYLFZXkdXgZUrgFN5R63gtgbGRRjxKjZ0IlYvXcDokSbAU=
jdk:
  - oraclejdk8
before_install:
  - source infrastructure/set_env.sh
  - docker-compose -f infrastructure/docker-compose-services.yml up -d
  - if [ ! -d $HOME/google-cloud-sdk/bin ]; then rm -rf $HOME/google-cloud-sdk; curl
    https://sdk.cloud.google.com | bash > /dev/null; fi
  - source $HOME/google-cloud-sdk/path.bash.inc
  - gcloud components update kubectl
  - gcloud version
  - chmod +x mvnw
script:
  - "./mvnw clean install"
deploy:
  skip_cleanup: true
  provider: script
  script: bash infrastructure/push_image_gcr.sh
  on:
    branch: dockerize_service
